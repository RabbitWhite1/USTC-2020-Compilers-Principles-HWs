# 2
PB1811697 王章瀚

---

## 1）
**问题: 试从产生的汇编代码总结gcc处理inline的特征，内联是在编译的什么阶段被处理？**

`gcc` 对 `inline` 只是视为一个指导, 具体是否做此优化还取决于其自身.  
因此当指定 `-O2` 的时候, `f` 被内联了, 而不指定时(默认应该是 `-O1`)则没有被内联.

而这个内联是在 `优化阶段` 被处理的, 而这个优化阶段应该是在 `生成汇编码` 时做的.

## 2)

优化:
- 内联了函数 `f`
    - 调用 `__printf_chk` 而非 `printf`, 可能是因为内联了, 需要检查栈?
- 类似复写传播的优化: 
    ```s
    movl    $1, 28(%esp)
    movl    28(%esp), %eax
    movl    %eax, (%esp)
    ```
    变成 `movl $1, (%esp)` 之类的

## 3)

**问题: 如果将inline.h第1行的static去掉，执行gcc inline.c inline1.c，产生如下错误，试说明原因，并指出这是在编译的哪个阶段产生的错误。**

按照提示, 明显是重定义. 原因就在于 `inline1.c` include 了一次 `inline.h`, 然后 `inline.c` 也 include 了一次.



